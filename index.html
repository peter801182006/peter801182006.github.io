<!DOCTYPE html>
<html>
<body>

<p>請輸入西元年分:</p>

<input id="yid" type="number" min="0" max="3000" required>
<p>請輸入月分:</p>

<input id="mid" type="number" min="1" max="12" required>
<p>請輸入日期:</p>

<input id="did" type="number" min="1" max="31" required>
<p>請輸入時間點:(時間點不知道可以任挑)</p>

<input id="hid" type="number" min="0" max="23" required><p>時</p>
<input id="miid" type="number" min="0" max="59" required><p>分</p>
<p>性別: (請輸入男或女即可)</p>
<input id="sexid" type="text">
<br>
<button onclick="myFunction()">OK</button>



<p>主要屬性:</p>
<p id="demo"></p>
<p id="tgdemo"></p>
<p>內心世界:</p>
<p id="demo2"></p>
<p id="dzdemo"></p>
<p>幸運色</p>
<p id="color"></p>
<p>今日運勢</p>
<p id="tengoddemo"></p>
<p id="fudemo"></p>
<script>
//日誌0:1/23
//日誌1:1/24 20:00-23:50
//日誌2:1/25 6:30-07:09 變數進不去
     var year = document.getElementById("yid");
     var month = document.getElementById("mid");
     var day = document.getElementById("did");
     var hour= document.getElementById("hid");
     var min= document.getElementById("miid");
    
    var synmonth = 29.530588853;     //synodic month (new Moon to new Moon)
//偏移量參數:
     ptsa = new Array(485, 203, 199, 182, 156, 136, 77, 74, 70, 58, 52, 50, 45, 44, 29, 18, 17, 16, 14, 12, 12, 12, 9, 8);
     ptsb = new Array(324.96, 337.23, 342.08, 27.85, 73.14, 171.52, 222.54, 296.72, 243.58, 119.81, 297.17, 21.02, 247.54, 325.15, 60.93, 155.12, 288.79, 198.04, 199.76, 95.39, 287.11, 320.81, 227.73, 15.45);
     ptsc = new Array(1934.136, 32964.467, 20.186, 445267.112, 45036.886, 22518.443, 65928.934, 3034.906, 9037.513, 33718.147, 150.678, 2281.226, 29929.562, 31555.956, 4443.417, 67555.328, 4562.452, 62894.029, 31436.921, 14577.848, 31931.756, 34777.259, 1222.114, 16859.074);
//
    var ctg = new Array("甲", "乙", "丙", "丁", "戊", "己", "庚", "辛", "壬", "癸");
    var cdz = new Array("子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥");
     jdez=new Array;
    
    var tgdata=[
	    "陽木，人如大樹，庇蔭無數，<br>有惻隱之心、上進心與植物般的韌性，能在逆境中開闢出屬於自己的一條路，<br>進退有情有義，處事認真負責，<br>不喜變動、吃軟不吃硬、喜明爭不喜暗鬥，適合當組織領導者。",
	    "陰木，人如藤蔓，盤根錯節，<br>富同情心、性情和藹，但內心佔有欲強，<br> 雖有才能, 但常因為興趣廣泛，覺得什麼都不錯，以至於無法定下來，<br>若能定下來朝固定領域發展能有大成就，<br>多俊男美女，適合幕後領導者。",
	    "陽火，人如大火，熱力四射，<br>熱情開朗、積極、喜照顧人、不拘小節<br>但性情急、沒心機、比較健忘，情緒來的快去得也快，<br>很少人能抵擋他(她)熱情的一面，易成為焦點人物，適合公關、業務",
	    "陰火，人如燈燭，燃燒自己照亮別人，<br>外靜內進、思想縝密，具有天生準確的第六感，<br>正因如此常憑感覺做事，喜歡靠近不喜歡就閃人，只相信眼見為憑，適合當老師。",
	    "陽土，人如大石，信言篤實，<br>性情篤實沉穩、為人憨直、外柔內剛、逆來順受、重誠信，<br>行事墨守成規，雖在學習吸收力一途是所有屬性中最差的(尤其丑月)，但一旦吸收進去不會忘記，是可造之材。",
	    "陰土，人如黏土，可塑性高，<br>主觀意識強、溝通能力強，為人重義氣、講信用、包容力強，<br>可塑性高、學習吸收力強，行事依循規矩，但常固執而不自覺，常有懷才不遇之感。",
	    "陽金，人如大釜，大刀闊斧，<br>粗曠豪爽、性情剛烈而重義氣，個性好勝、人緣佳、 容易相處，<br>行事直來直往，有話直說，且直切要點，但往往得罪人而不自知，適合白手起家。",
	    "陰金，人如寶玉，寶氣暗藏，<br>溫文儒雅、重感情、毅力，表現突出，有強烈的自尊心，<br>有恆心、行事循序漸進，為追求夢想不遺餘力，辛是辛苦的辛，一生需要辛勤勞絕，才會成功，而通常成就是一般人的兩倍以上，適合白手起家。",
	    "陽水，人如江流，一洩千里，<br>寬宏大度之意, 能潛伏和包容，膽大心細、人緣好，<br>沒心機、作人圓滑不易得罪人，做事直接快速，但容易欠缺慎重思考而壞事，反應靈敏，見危險就閃，因此犯錯的機率較少，善於計，算賺錢快，虧錢也快，事業容易有成就。",
	    "陰水，人如雨露，，<br>聰明、交際廣、人緣佳，善於經營，其人平靜、柔和、內向、勤勉力行,<br> 然而每愛好猜臆，注重原則，不務實際，故內心常蓄不平，並且有重情調，有鑽牛角尖的傾向，不論大小事都要管，事業容易有成就。"];
	
    var dzdata=["善於保護自己，個性讓人捉摸不定，有居安思危的觀念。<br>盤算打得精，因而因小失大，易聰明反被聰明誤。<br>做決定容易比人慢，如果要揪周遭子月的朋友吃飯、出遊，請二選一給他選擇。<br>容易有始無終，需學習堅持到底的精神，成功就在你眼前。",
		"本性善良，耐力好、喜歡安定、任勞任怨，勤勞且腳踏實地。<br>但脾氣很大、學習力差，容易因專注忽略的現實周遭。<br>對地理、命理特別敏感。喜追根究底，宜越挫越勇。",
		"為衝動派、好動、愛自由、坐不住。野心大、不服輸，只要旁人側面的問\"怎麼辦?\"，就會跳出去幫助他。樂觀積極又仁慈。自我期許高，既能幹又肯做事，掌控能力強，沉著內斂，不會推卸責任，屬完美主義者，爆發力強，但往往後繼無力，且生性驕傲，明顯固執，不太能接受人家批評。寅月的人適合做行銷。",
		"智慧高，完美主義者。有衝勁，狡猾善變。有人緣，有桃花，機警，閒不住，防衛性強。不容易顯老，文靜，喜愛乾淨，有潔癖，心地善良。只能接受成功，不能坦然面對失敗，容易有始無終。第六感很強，直覺性敏銳。屬兔的男性善於裝蒜，善應對，即使犯錯也不輕易認錯，最適「狡兔三窟」。辦公室戀曲稀鬆平常，常會吃窩邊草。喜歡羅曼蒂克，異性緣佳，容易獲得職場異性的幫助。兔女郎本性善良，為保護自己，偶而也會偽裝。",
		"喜當老大，非常自負，好高騖遠，喜奉承巴結，勢力，亦有桃花緣。思想變化快，點子多，聰明。多半好面子，喜歡被尊重，喜歡人家「說好聽的話」，眼光高，看高不看低（做事不實際）。個性千變萬化，常給人神龍見首不見尾的神秘感。屬龍女性比男性更善變，內心世界不容易被察覺。福報不錯，常化險為夷。多才多藝，學什麼像什麼，容易有成就，通常有「精神潔癖」的傾向。是事業上好夥伴及熱心助人的好友。",
		"喜歡聊天，好辯，不服輸，敏捷好辯又好訴訟。很會鑽研，分析力強，外表冷漠，內心如火，對喜歡的人說話較多。個性冰冷，城府很深，好辯，猜疑心重。冷靜沉著，有眼光，有遠見，數字概念清楚，善於理財，為生意上好角色。適合做業務推動。屬蛇女性有一種神秘力量。心思細密，看來聰明，主觀太強，很難約束。包容力大，若觸怒之反撲力量很強。善於自處，且能力相當強。",
		"好勝心強，禁不起刺激，受刺激必有回應，口服心不服。急躁，容易被設計。奔波，勞碌，憨直，性直，心腸軟。脾氣很拗，敢衝敢拼，對朋友熱情，喜拍馬屁。很樂觀，喜交際，有人緣。性情不定，好惡分明，喜怒哀樂形於色，易招惹是非。性格奔放，喜自由，急躁且欲速則不達，若能修正心性調整處世，越老越有成就。屬馬男性異性緣好，適合從事與女性有關行業，在同業中容易被排擠。屬馬女性多半帶有男性性格，膽子大，多操勞，閒不下來，老年時易變成嘮叨老人。",
		"為人親切，富人情味，一絲不苟，行事謹慎。孝順，但不知如何表達，個性膽小，注重外表，喜鑽牛角尖，打破砂鍋問到底，愛生氣。內心喜歡當領導人物，但須依附他人方能成功。對感情專注忠貞。男性屬羊，多半聰明，喜歡表現自己。",
		"好動有衝勁，重義氣，坐不住，沒一時閒著。善模仿，學習能力強，但只有三分鐘熱度，沒耐心。猴急，狡猾善變，喜走捷徑。觀察力敏銳，心思細膩，富機智，能力強，但欠缺穩重。喜歡招搖，帶點風騷，異性緣好，希望自己是群體中最受注目的焦點。屬猴女性頗有女人味。",
		"沒有衝勁，較悲觀。雞婆個性，急躁，雙重個性。熱心喜服務人群，積極主動，會較從自己利益著眼。很有審美觀，自信心、自尊心、虛榮心都很強，而且喜歡被讚美。第六感強。屬雞男性給人一種愛拈花惹草的感覺，異性緣特別好。屬雞女性多半帶點「雞婆」個性，喜歡替人出主意，喜歡湊熱鬧，人緣很好，也很重視感覺。",
		"想當老大，易突發奇想，率性而為，而有驚人之舉，不為環境而改變，從一而終，認定人與事。講忠心，信用佳，善良，固執，重感情，是好朋友及好部屬。好惡分明，十分謹慎，戒心很強，不隨便相信人。常出現五行高手，對研究玄學很投入。人間福報好，無形福報多，常遇貴人逢凶化吉。賺錢不難，不容易缺錢，但欠缺金錢觀，難有鉅額財富。想法樂觀積極，不太會隱藏自己個性及秘密，特別喜歡照顧別人。有時會有狗改不了吃屎的習慣。死心眼，易單戀，或被戀愛衝昏頭。",
		"很有智慧，非常注重原則，不易溝通，常把事情放心裡。外表剛毅，內心脆弱，性格矛盾，不易了解。善利用別人，借力使力，為生意高手。很明理，但常追根究底，有時會很「番」，不講道理。口才好，好辯。眼光獨特，極有開創力。很注重口腹之慾，重享受卻不挑食。會扮豬吃老虎。"];

function myFunction() {
     var yy =Number(year.value);
     var mm =Number( month.value);
     var dd =Number( day.value);
     var hh= Number(hour.value);
     var mimi= Number(min.value);
//      alert(typeof(yy));
    if (!ValidDate()) {
//         document.getElementById("demo").innerHTML ="時間點不正確，請重新輸入" ;
	    alert("時間點不正確，請重新輸入");
    } else {  
	var a=Jdays(yy,mm,dd,hh+(mimi/60));
        var otg=new Array;
	var odz=new Array;

         GetGZ(a,yy,ptsa,ptsb,ptsc,otg,odz);
	    
	document.getElementById("demo").innerHTML  = otg[2];    
	document.getElementById("demo2").innerHTML = odz[1]; 

        //外在性格分析
        if(otg[2]=="甲"){
                  document.getElementById("tgdemo").innerHTML  =tgdata[0];
	}else if(otg[2]=="乙"){
                  document.getElementById("tgdemo").innerHTML  =tgdata[1];
	}else if(otg[2]=="丙"){
                  document.getElementById("tgdemo").innerHTML  =tgdata[2];
	}else if(otg[2]=="丁"){
                  document.getElementById("tgdemo").innerHTML  =tgdata[3];
	}else if(otg[2]=="戊"){
                  document.getElementById("tgdemo").innerHTML  =tgdata[4];
	}else if(otg[2]=="己"){
                  document.getElementById("tgdemo").innerHTML  =tgdata[5];
	}else if(otg[2]=="庚"){
                  document.getElementById("tgdemo").innerHTML  =tgdata[6];
	}else if(otg[2]=="辛"){
                  document.getElementById("tgdemo").innerHTML  =tgdata[7];
	}else if(otg[2]=="壬"){
                  document.getElementById("tgdemo").innerHTML  =tgdata[8];
	}else if(otg[2]=="癸"){
                  document.getElementById("tgdemo").innerHTML  =tgdata[9];
	}
        //內在習性分析 
	if(odz[1]=="子"){
		document.getElementById("dzdemo").innerHTML  =dzdata[0];
	}else if(odz[1]=="丑"){
		document.getElementById("dzdemo").innerHTML  =dzdata[1];
	}else if(odz[1]=="寅"){
		document.getElementById("dzdemo").innerHTML  =dzdata[2];
	}else if(odz[1]=="卯"){
		document.getElementById("dzdemo").innerHTML  =dzdata[3];
	}else if(odz[1]=="辰"){
		document.getElementById("dzdemo").innerHTML  =dzdata[4];
	}else if(odz[1]=="巳"){
		document.getElementById("dzdemo").innerHTML  =dzdata[5];
	}else if(odz[1]=="午"){
		document.getElementById("dzdemo").innerHTML  =dzdata[6];
	}else if(odz[1]=="未"){		
		document.getElementById("dzdemo").innerHTML  =dzdata[7];
	}else if(odz[1]=="申"){
		document.getElementById("dzdemo").innerHTML  =dzdata[8];
	}else if(odz[1]=="酉"){
		document.getElementById("dzdemo").innerHTML  =dzdata[9];
	}else if(odz[1]=="戌"){
		document.getElementById("dzdemo").innerHTML  =dzdata[10];
	}else if(odz[1]=="亥"){
		document.getElementById("dzdemo").innerHTML  =dzdata[11];
	}
	    
        //幸運色判斷  
        var sex=document.getElementById("sexid").value;
	var sexbase=["",""];
        if(sex=="男"){sexbase[0]="與愛情運";}
        else if(sex=="女"){sexbase[1]="與愛情運";}
        else {alert("請輸入中文的性別");}
        var colorbase=["綠色系","粉紅、紅色系","黃色、咖啡色色系","銀白色系","藍黑色系"];   
        if(otg[2]=="甲"||otg[2]=="乙"){
                 document.getElementById("color").innerHTML=
                  "求身體健康"+":"+colorbase[0]+"<br>"
                  +"求才華"+":"+ colorbase[1]+"<br>"
                  +"求財運"+sexbase[0]+":"+colorbase[2]+"<br>"
                  +"求考運"+sexbase[1]+":"+colorbase[3]+"<br>"
                  +"求貴人"+":"+colorbase[4]+"<br>";      
        }else if(otg[2]=="丙"||otg[2]=="丁"){
                 document.getElementById("color").innerHTML=
                  "求身體健康"+":"+colorbase[1]+"<br>"
                  +"求才華"+":"+ colorbase[2]+"<br>"
                  +"求財運"+sexbase[0]+":"+colorbase[3]+"<br>"
                  +"求考運"+sexbase[1]+":"+colorbase[4]+"<br>"
                  +"求貴人"+":"+colorbase[0]+"<br>";      
        }else if(otg[2]=="戊"||otg[2]=="己"){
                 document.getElementById("color").innerHTML=
                  "求身體健康"+":"+colorbase[2]+"<br>"
                  +"求才華"+":"+ colorbase[3]+"<br>"
                  +"求財運"+sexbase[0]+":"+colorbase[4]+"<br>"
                  +"求考運"+sexbase[1]+":"+colorbase[0]+"<br>"
                  +"求貴人"+":"+colorbase[1]+"<br>";      
        }else if(tg[2]=="庚"||tg[2]=="辛"){
                 document.getElementById("color").innerHTML=
                  "求身體健康"+":"+colorbase[3]+"<br>"
                  +"求才華"+":"+ colorbase[4]+"<br>"
                  +"求財運"+sexbase[0]+":"+colorbase[0]+"<br>"
                  +"求考運"+sexbase[1]+":"+colorbase[1]+"<br>"
                  +"求貴人"+":"+colorbase[2]+"<br>";      
        }else if(otg[2]=="壬"||otg[2]=="癸"){
                 document.getElementById("color").innerHTML=
                  "求身體健康"+":"+colorbase[4]+"<br>"
                  +"求才華"+":"+colorbase[0]+"<br>"
                  +"求財運"+sexbase[0]+":"+colorbase[1]+"<br>"
                  +"求考運"+sexbase[1]+":"+colorbase[2]+"<br>"
                  +"求貴人"+colorbase[3]+"<br>";      
        }
	    
        //今日運勢  

        var Today=new Date();  
	var tdyy=Number(Today.getFullYear());
	    alert(tdyy);
        var tdmm=Number(Today.getMonth())+1;
        var tddd=Number(Today.getDate());
	var tdhh=Number(Today.getHours());
        var tdmimi=Number(Today.getMinutes());
        var tda=Jdays(tdyy,tdmm,tddd,tdhh+(tdmimi/60));
        var tdtg=new Array;
	var tddz=new Array;
	GetGZ(tda,tdyy,ptsa,ptsb,ptsc,tdtg,tddz);    
	var tdid=tgtest(otg[2],tdtg[2]);
	document.getElementById("tengoddemo").innerHTML  =tdid;
	
    }    
    
	
}
	   
function tgtest(cc,uu){
	var tengod=["七殺","正官","偏印","正印","比肩","劫財","食神","傷官","偏財","正財"];
        var tenex=["七殺",
		   "正官",
		   "偏印",
		   "正印",
		   "比肩",
		   "劫財",
		   "食神",
		   "傷官",
		   "偏財",
                   "正財"]
        if(cc=="甲"){
	           if(uu=="甲"){ 
			   return tengod[4]+";"+tenex[4];
		   }else if(uu=="乙"){ 
			   return tengod[5]+";"+tenex[5];
		   }else if(uu=="丙"){ 
			   return tengod[6]+";"+tenex[6];
	           }else if(uu=="丁"){ 
			   return tengod[7]+";"+tenex[7];
	           }else if(uu=="戊"){ 
			   return tengod[8]+";"+tenex[8];
                   }else if(uu=="己"){ 
			   return tengod[9]+";"+tenex[9];
                   }else if(uu=="庚"){ 
			   return tengod[0]+";"+tenex[0];
                   }else if(uu=="辛"){ 
			   return tengod[1]+";"+tenex[1];
                   }else if(uu=="壬"){ 
			   return tengod[2]+";"+tenex[2];
                   }else if(uu=="癸"){ 
			   return tengod[3]+";"+tenex[3];
		   }
 
	}else if(cc=="乙"){
		   if(uu=="甲"){ 
			   return tengod[5]+";"+tenex[5];
		   }else if(uu=="乙"){ 
			   return tengod[4]+";"+tenex[4];
		   }else if(uu=="丙"){ 
			   return tengod[7]+";"+tenex[7];
	           }else if(uu=="丁"){ 
			   return tengod[6]+";"+tenex[6];
	           }else if(uu=="戊"){ 
			   return tengod[9]+";"+tenex[9];
                   }else if(uu=="己"){ 
			   return tengod[8]+";"+tenex[8];
                   }else if(uu=="庚"){ 
			   return tengod[1]+";"+tenex[1];
                   }else if(uu=="辛"){ 
			   return tengod[0]+";"+tenex[0];
                   }else if(uu=="壬"){ 
			   return tengod[3]+";"+tenex[3];
                   }else if(uu=="癸"){ 
			   return tengod[2]+";"+tenex[2];
		   }
	}else if(cc=="丙"){
		   if(uu=="甲"){ 
			   return tengod[2]+";"+tenex[2];
		   }else if(uu=="乙"){ 
			   return tengod[3]+";"+tenex[3];
		   }else if(uu=="丙"){ 
			   return tengod[4]+";"+tenex[4];
	           }else if(uu=="丁"){ 
			   return tengod[5]+";"+tenex[5];
	           }else if(uu=="戊"){ 
			   return tengod[6]+";"+tenex[6];
                   }else if(uu=="己"){ 
			   return tengod[7]+";"+tenex[7];
                   }else if(uu=="庚"){ 
			   return tengod[8]+";"+tenex[8];
                   }else if(uu=="辛"){ 
			   return tengod[9]+";"+tenex[9];
                   }else if(uu=="壬"){ 
			   return tengod[0]+";"+tenex[0];
                   }else if(uu=="癸"){ 
			   return tengod[1]+";"+tenex[1];
		   }
	}else if(cc=="丁"){
		   if(uu=="甲"){ 
			   return tengod[3]+";"+tenex[3];
		   }else if(uu=="乙"){ 
			   return tengod[2]+";"+tenex[2];
		   }else if(uu=="丙"){ 
			   return tengod[5]+";"+tenex[5];
	           }else if(uu=="丁"){ 
			   return tengod[4]+";"+tenex[4];
	           }else if(uu=="戊"){ 
			   return tengod[7]+";"+tenex[7];
                   }else if(uu=="己"){ 
			   return tengod[6]+";"+tenex[6];
                   }else if(uu=="庚"){ 
			   return tengod[9]+";"+tenex[9];
                   }else if(uu=="辛"){ 
			   return tengod[8]+";"+tenex[8];
                   }else if(uu=="壬"){ 
			   return tengod[1]+";"+tenex[1];
                   }else if(uu=="癸"){ 
			   return tengod[0]+";"+tenex[0];
		   }
	}else if(cc=="戊"){
		   if(uu=="甲"){ 
			   return tengod[0]+";"+tenex[0];
		   }else if(uu=="乙"){ 
			   return tengod[1]+";"+tenex[1];
		   }else if(uu=="丙"){ 
			   return tengod[2]+";"+tenex[2];
	           }else if(uu=="丁"){ 
			   return tengod[3]+";"+tenex[3];
	           }else if(uu=="戊"){ 
			   return tengod[4]+";"+tenex[4];
                   }else if(uu=="己"){ 
			   return tengod[5]+";"+tenex[5];
                   }else if(uu=="庚"){ 
			   return tengod[6]+";"+tenex[6];
                   }else if(uu=="辛"){ 
			   return tengod[7]+";"+tenex[7];
                   }else if(uu=="壬"){ 
			   return tengod[8]+";"+tenex[8];
                   }else if(uu=="癸"){ 
			   return tengod[9]+";"+tenex[9];
		   }
	}else if(cc=="己"){
		   if(uu=="甲"){ 
			   return tengod[1]+";"+tenex[1];
		   }else if(uu=="乙"){ 
			   return tengod[0]+";"+tenex[0];
		   }else if(uu=="丙"){ 
			   return tengod[3]+";"+tenex[3];
	           }else if(uu=="丁"){ 
			   return tengod[2]+";"+tenex[2];
	           }else if(uu=="戊"){ 
			   return tengod[5]+";"+tenex[5];
                   }else if(uu=="己"){ 
			   return tengod[4]+";"+tenex[4];
                   }else if(uu=="庚"){ 
			   return tengod[7]+";"+tenex[7];
                   }else if(uu=="辛"){ 
			   return tengod[6]+";"+tenex[6];
                   }else if(uu=="壬"){ 
			   return tengod[9]+";"+tenex[9];
                   }else if(uu=="癸"){ 
			   return tengod[8]+";"+tenex[8];
		   }
	}else if(cc=="庚"){
		   if(uu=="甲"){ 
			   return tengod[8]+";"+tenex[8];
		   }else if(uu=="乙"){ 
			   return tengod[9]+";"+tenex[9];
		   }else if(uu=="丙"){ 
			   return tengod[0]+";"+tenex[0];
	           }else if(uu=="丁"){ 
			   return tengod[1]+";"+tenex[1];
	           }else if(uu=="戊"){ 
			   return tengod[2]+";"+tenex[2];
                   }else if(uu=="己"){ 
			   return tengod[3]+";"+tenex[3];
                   }else if(uu=="庚"){ 
			   return tengod[4]+";"+tenex[4];
                   }else if(uu=="辛"){ 
			   return tengod[5]+";"+tenex[5];
                   }else if(uu=="壬"){ 
			   return tengod[6]+";"+tenex[6];
                   }else if(uu=="癸"){ 
			   return tengod[7]+";"+tenex[7];
		   }
	}else if(cc=="辛"){
		   if(uu=="甲"){ 
			   return tengod[9]+";"+tenex[9];
		   }else if(uu=="乙"){ 
			   return tengod[8]+";"+tenex[8];
		   }else if(uu=="丙"){ 
			   return tengod[1]+";"+tenex[1];
	           }else if(uu=="丁"){ 
			   return tengod[0]+";"+tenex[0];
	           }else if(uu=="戊"){ 
			   return tengod[3]+";"+tenex[3];
                   }else if(uu=="己"){ 
			   return tengod[2]+";"+tenex[2];
                   }else if(uu=="庚"){ 
			   return tengod[5]+";"+tenex[5];
                   }else if(uu=="辛"){ 
			   return tengod[4]+";"+tenex[4];
                   }else if(uu=="壬"){ 
			   return tengod[7]+";"+tenex[7];
                   }else if(uu=="癸"){ 
			   return tengod[6]+";"+tenex[6];
		   }
	}else if(cc=="壬"){
                   if(uu=="甲"){ 
			   return tengod[6]+";"+tenex[6];
		   }else if(uu=="乙"){ 
			   return tengod[7]+";"+tenex[7];
		   }else if(uu=="丙"){ 
			   return tengod[8]+";"+tenex[8];
	           }else if(uu=="丁"){ 
			   return tengod[9]+";"+tenex[9];
	           }else if(uu=="戊"){ 
			   return tengod[0]+";"+tenex[0];
                   }else if(uu=="己"){ 
			   return tengod[1]+";"+tenex[1];
                   }else if(uu=="庚"){ 
			   return tengod[2]+";"+tenex[2];
                   }else if(uu=="辛"){ 
			   return tengod[3]+";"+tenex[3];
                   }else if(uu=="壬"){ 
			   return tengod[4]+";"+tenex[4];
                   }else if(uu=="癸"){ 
			   return tengod[5]+";"+tenex[5];
		   }
	}else if(cc=="癸"){
                   if(uu=="甲"){ 
			   return tengod[7]+";"+tenex[7];
		   }else if(uu=="乙"){ 
			   return tengod[6]+";"+tenex[6];
		   }else if(uu=="丙"){ 
			   return tengod[9]+";"+tenex[9];
	           }else if(uu=="丁"){ 
			   return tengod[8]+";"+tenex[8];
	           }else if(uu=="戊"){ 
			   return tengod[1]+";"+tenex[1];
                   }else if(uu=="己"){ 
			   return tengod[0]+";"+tenex[0];
                   }else if(uu=="庚"){ 
			   return tengod[3]+";"+tenex[3];
                   }else if(uu=="辛"){ 
			   return tengod[2]+";"+tenex[2];
                   }else if(uu=="壬"){ 
			   return tengod[5]+";"+tenex[5];
                   }else if(uu=="癸"){ 
			   return tengod[4]+";"+tenex[4];
		   }
	}

}
//ValidDate()已於1/24上午6:35確認可執行
function ValidDate(){
        var vd=true;
	if(month.checkValidity()==false){
           vd=false;
	}else{

           var u1=-(year.value%4==0);//能被4整除-1其餘為0
           var u2=( (year.value%100==0)-(year%400==0) )&&(year>1582);//1582以後且年份能被100整除，但不能被400除盡的年份不是閏年
           var u=u1+u2;
           //計算當月天數 以7.5月為中央 與中央差+0.5%2餘數為1的才要加1 ，當月分為2才須減2或減1(閏年)
           var vmd=30+( (Math.abs(month.value-7.5)+0.5) %2)-(month.value==2)*(2+u)
           if(day.checkValidity()==false || day.value>vmd){
		if(u==0 && month.value==2 && day.value==29){
			if(hour.checkValidity()==false ||min.checkValidity()==false){
			   alert("時間點不正確，請重新輸入");
		        }else{
                           alert("此年無閏月");
			}
		}else{
		   	alert("時間點不正確，請重新輸入");
                }
	        vd=false;
            }
	    if(year.value ==1582 && month.value==10 && day.value>=5 &&day.value<15||hour.checkValidity()==false ||min.checkValidity()==false){
                alert("時間點不正確，請重新輸入");
                vd=false;
	    }
	}
//         if(vd==true)document.getElementById("demo").innerHTML = "甲";
//         else document.getElementById("demo").innerHTML = "乙";
        return vd;
		   
}
// function Jtime(){
	
// }
	
//計算當年春分點
function VE(yy){
    var yx=yy;
    if(yx>=1000 && yx<=8001){
	   var m=(yx-2000)/1000;
	   jdve=2451623.80984+365242.37404*m+0.05169*m*m-0.00411*m*m*m-0.00057*m*m*m*m;
    }else{
	    if(yx>=0 && yx<1000){
		   m=yx/1000;
		   jdve=1721139.29189+365242.1374*m+0.06134*m*m+0.00111*m*m*m-0.00071*m*m*m*m;
	    }else{
		   alert("超出计算能力范围");
		   return false;
	    }
    }
         return jdve
}

function MeanJQJD(yy,jdve,ty,ini,num){
//for 偏心率計算:------------------------------------------------
   var ath=2*Math.PI/24;
   var tx=(jdve-2451545)/365250;
   var e=0.0167086342-0.0004203654*tx-0.0000126734*tx*tx+0.0000001444*tx*tx*tx-0.0000000002*tx*tx*tx*tx+0.0000000003*tx*tx*tx*tx*tx;
//每年退行角度計算:-----------------------------------------------
   var tt=yy/1000;       
//       計算式
   var vp=111.25586939-17.0119934518333*tt-0.044091890166673*tt*tt-4.37356166661345E-04*tt*tt*tt+8.16716666602386E-06*tt*tt*tt*tt;
//       轉成徑度量
   var rvp=vp*2*Math.PI/360;
//切割點:
   var peri = new Array(30);
   var i;
   for(i=1;i<=(ini+num);i++){
	    var flag=0;
	    var th=ath*(i-1)+rvp;
	    if(th>Math.PI && th<=3*Math.PI){
		     th=2*Math.PI-th;
		     flag=1;
	    }
	    if(th>3*Math.PI){
		     th=4*Math.PI-th;
		     flag=2;
	    }
	    var f1=2*Math.atan((Math.sqrt((1-e)/(1+e))*Math.tan(th/2)));
	    var f2=(e*Math.sqrt(1-e*e)*Math.sin(th))/(1+e*Math.cos(th));
	    var f=(f1-f2)*ty/2/Math.PI;
	    if(flag==1) f=ty-f;
	    if(flag==2) f=2*ty-f;
	    peri[i]=f;
   }
   for(i=ini;i<=(ini+num);i++){
	    jdez[i]=jdve+peri[i]-peri[1];
   }
   return true;
}
	
function Perturbation(jdez){
     var t=(jdez-2451545)/36525;
     var s=0;
     for(k=0;k<=23;k++){
	s=s+ptsa[k]*Math.cos(ptsb[k]*2*Math.PI/360+ptsc[k]*2*Math.PI/360*t);
     }
     var w=35999.373*t-2.47;
     var l=1+0.0334*Math.cos(w*2*Math.PI/360)+0.0007*Math.cos(2*w*2*Math.PI/360);
     var ptb=0.00001*s/l;
     return ptb;
}

function DeltaT(yy , mm ){
     var u, t, dt, y;
     y = yy + (mm - 0.5) / 12;

     if(y<=-500){	
	u = (y - 1820) / 100;
	dt = (-20 + 32*u*u);}
     else{if(y< 500){
	u = y / 100;
	dt=(10583.6-1014.41*u+33.78311*u*u-5.952053*u*u*u-0.1798452*u*u*u*u+0.022174192*u*u*u*u*u+0.0090316521*u*u*u*u*u*u);}
     else{if(y<1600){
	u = (y - 1000) / 100;
	dt = (1574.2-556.01*u+71.23472*u*u+0.319781*u*u*u-0.8503463*u*u*u*u-0.005050998*u*u*u*u*u+ 0.0083572073*u*u*u*u*u*u);}
     else{if(y<1700){
	t = y - 1600;
	dt = (120 - 0.9808 * t - 0.01532 * t*t + t*t*t / 7129);}
     else{if(y<1800){
	t = y - 1700;
	dt = (8.83 + 0.1603 * t - 0.0059285 * t*t + 0.00013336 * t*t*t - t*t*t*t / 1174000);}
     else{if(y<1860){
	t = y - 1800;
	dt=(13.72-0.332447*t+0.0068612*t*t+0.0041116*t*t*t-0.00037436*t*t*t*t+0.0000121272*t*t*t*t*t-0.0000001699*t*t*t*t*t*t+ 0.000000000875*t*t*t*t*t*t*t);}
     else{if(y<1900){
	t = y - 1860;
	dt = (7.62 + 0.5737 * t - 0.251754 * t*t + 0.01680668 * t*t*t - 0.0004473624 * t*t*t*t + t*t*t*t*t / 233174);}
     else{if(y<1920){
	t = y - 1900;
	dt = (-2.79 + 1.494119 * t - 0.0598939 * t*t + 0.0061966 * t*t*t - 0.000197 * t*t*t*t);}
     else{if(y<1941){
	t = y - 1920;
	dt = (21.2 + 0.84493 * t - 0.0761 * t*t + 0.0020936 * t*t*t);}
     else{if(y<1961){
	t = y - 1950;
	dt = (29.07 + 0.407 * t - t*t / 233 + t*t*t / 2547);}
     else{if(y<1986){
	t = y - 1975;
	dt = (45.45 + 1.067 * t - t*t / 260 - t*t*t / 718);}
     else{if(y<2005){
	t = y - 2000;
	dt = (63.86 + 0.3345 * t - 0.060374 * t*t + 0.0017275 * t*t*t + 0.000651814 * t*t*t*t + 0.00002373599 * t*t*t*t*t);}
     else{if(y<2050){
	t = y - 2000;
	dt = (62.92 + 0.32217 * t + 0.005589 * t*t);}
     else{if(y<2150){
	u = (y - 1820) / 100;
	dt = (-20 + 32*u*u-0.5628*(2150 - y));}
     else{
	u = (y - 1820) / 100;
	dt = (-20 + 32*u*u);}}}}}}}}}}}}}}

        if(y<1955 || y>=2005) dt=dt-(0.000012932*(y-1955)*(y-1955));
        var DeltaT = dt / 60;    //將秒轉換為分
        return DeltaT
}

function Jdays( yr,mh,dy,hr ){//將年月日時，轉换爲儒略日 
        
        var yp=yr+Math.floor((mh-3)/10);
        if(((yr>1582) || (yr==1582 && mh>10) || (yr==1582 && mh==10 && dy>=15))){
	     var init=1721119.5;
	     var jdy=Math.floor(yp*365.25)-Math.floor(yp/100)+Math.floor(yp/400);
        }else{
	    if((yr<1582) || (yr==1582 && mh<10) || (yr==1582 && mh==10 && dy<=4)){
		var init=1721117.5;
		var jdy=Math.floor(yp*365.25);
	    }else {return false;}
        }
	var mp=Math.floor(mh+9)%12; 
        var jdm=mp*30+Math.floor((mp+1)*34/57);
        var jdd=dy-1;
        var jdh=hr/24;
        
        var jd=jdy+jdm+jdd+jdh+init;
        return jd;
}
	
	
//////////////////////////////////////////////////////////
function Jtime(op,jd){//将儒略日转换为年月日时分秒
if(jd>=2299160.5 || op){
	var y4h=146097;
	var init=1721119.5;
}
else{
	var y4h=146100;
	var init=1721117.5;
}
var jdr=Math.floor(jd-init);
var yh=y4h/4;
var cen=Math.floor((jdr+0.75)/yh);
var d=Math.floor(jdr+0.75-cen*yh);
var ywl=1461/4;
var jy=Math.floor((d+0.75)/ywl);
d=Math.floor(d+0.75-ywl*jy+1);
var ml=153/5;
mp=Math.floor((d-0.5)/ml);
d=Math.floor((d-0.5)-30.6*mp+1);
var y=(100*cen)+jy;
var m=(mp+2)%12+1;
if(m<3) y=y+1;
var sd=Math.floor((jd+0.5-Math.floor(jd+0.5))*24*60*60+0.00005);
var mt=Math.floor(sd/60);
var ss=sd%60;
var hh=Math.floor(mt/60);
var mmt=mt%60;
var yy=Math.floor(y);
var mm=Math.floor(m);
var dd=Math.floor(d);
var yc="     "+yy;
yc=yc.substr(yc.length-5,5);
var dytm=yc;dytm+="年";
dytm+= ((mm < 10) ? "0" : "") + mm+"月";
dytm+= ((dd < 10) ? "0" : "") + dd+"日";
dytm+= ((hh < 10) ? "0" : "") + hh+"时";
dytm+= ((mmt < 10) ? "0" : "") + mmt+"分";
dytm+= ((ss < 10) ? "0" : "") + ss+"秒";
return dytm;
}

//副程式功能：對Perturbaton作調整後的自春分點開始的24節氣,可只取部份
function GetAdjustedJQ(yy, ini, num, jdjq){
var veb=VE(yy);
var ty=VE(yy+1)-veb;     //求指定年的春分點及回歸年長
if(MeanJQJD(yy,veb,ty,ini,num)==true){	//輸入指定年,JD,回歸年長,求該回歸年各節氣之長
		for(i=ini+1;i<=(ini+num);i++){
			ptb=Perturbation(jdez[i]);	//取得受perturbation影響所需微調
			dt=DeltaT(yy,Math.floor(i/2)+3);	//修正dynamical time to Universal time
			jdjq[i]=jdez[i]+ptb-dt/60/24;	//加上攝動調整值ptb，減去對應的Delta T值(分鐘轉換為日)
			jdjq[i]=jdjq[i]+1/3;	//因中國時間比格林威治時間先行8小時，即1/3日
		}
	}

}

//副程式功能：求出以立春點開始的不含中氣之12節氣
function GetPureJQsinceSpring(yy, ptsa,ptsb,ptsc, jdpjq){
var sjdjq=new Array;
var yea = yy - 1;
GetAdjustedJQ(yea, 21, 3, sjdjq);   //求出含指定年立春開始之3個節氣JD值,以前一年的年值代入
//轉移春分前之立春至驚蟄之節氣至jdpjq變數中，以重整index
jdpjq[0] =sjdjq[22];                     //此為立春
jdpjq[1] =sjdjq[24];                     //此為驚蟄
yea = yy;
GetAdjustedJQ(yea, 0, 26, sjdjq);       //求出指定年節氣之JD值,從驚蟄開始，到雨水
//轉移春分至小寒之節氣至jdpjq變數中，以重整index
for(i=1;i<=13;i++){
    jdpjq[i+1] = sjdjq[2 * i];
}
}
// 1/25 07:05 bug變數進不去
function GetGZ(spcjd,ya,ptsa,ptsb,ptsc,tg,dz){
   var ty;
   var td;
   var dh;
	
//比較求算節氣年ty,求出年干支
   var jr=new Array;
   GetPureJQsinceSpring(ya, ptsa,ptsb,ptsc,jr);	//取得自立春開始的非中氣之24節氣
   if(spcjd <jr[0]){	//jr[0]為立春，約在2月5日前後，
        ty = ya - 1;
       //若小於jr[0],則屬於前一個節氣年
       GetPureJQsinceSpring(ty, ptsa,ptsb,ptsc,jr);     //取得自立春開始的不含中氣之12節氣  
   }else{ty=ya;}
//alert(ty);
   switch(ty%10){
	case 0:
		tg[0]="庚";
		break;
	case 1:
		tg[0]="辛";
                break;
        case 2:
		tg[0]="壬";
		break;
        case 3:
		tg[0]="癸";
		break;
	case 4:
		tg[0]="甲";
		break;
	case 5:
		tg[0]="乙";
		break;
        case 6:
		tg[0]="丙";
		break;
	case 7:
		tg[0]="丁";
		break;
	case 8:
		tg[0]="戊";
		break;
	case 9:
		tg[0]="己";
		break;
      }
	switch(ty%12){
		case 0:
			dz[0]="申";
			break;
		case 1:
			dz[0]="酉";
			break;
		case 2:
			dz[0]="戌";
			break;
		case 3:
			dz[0]="亥";
			break;
		case 4:
			dz[0]="子";
			break;
		case 5:
			dz[0]="丑";
			break;
		case 6:
			dz[0]="寅";
			break;
		case 7:
			dz[0]="卯";
			break;
		case 8:
			dz[0]="辰";
			break;
		case 9:
			dz[0]="巳";
			break;
		case 10:
			dz[0]="午";
			break;
		case 11:
			dz[0]="未";
			break;
		}
	var j,tm,tmm; 	
        //比較求算節氣月,求出月干支
	for(j=0;j<=13;j++){
		if(jr[j] >= spcjd){ tm = j - 1; break;}		//已超過指定時刻，故應取前一個節氣
	}
        //alert(tm);
	switch(tm%12){
		case 0:
			dz[1]="寅";
			break;
		case 1:
			dz[1]="卯";
			break;
		case 2:
			dz[1]="辰";
			break;
		case 3:
			dz[1]="巳";
			break;
		case 4:
			dz[1]="午";
			break;
		case 5:
			dz[1]="未";
			break;
		case 6:
			dz[1]="申";
			break;
		case 7:
			dz[1]="酉";
			break;
		case 8:
			dz[1]="戌";
			break;
		case 9:
			dz[1]="亥";
			break;
		case 10:
			dz[1]="子";
			break;
		case 11:
			dz[1]="丑";
			break;
	}
	if(tg[0]=="甲"||tg[0]=="己"){
		switch(tm%12){
			case 0:
				tg[1]="丙";
				break;
			case 1:
				tg[1]="丁";
				break;
			case 2:
				tg[1]="戊";
				break;
			case 3:
				tg[1]="己";
				break;
			case 4:
				tg[1]="庚";
				break;
			case 5:
				tg[1]="辛";
				break;
			case 6:
				tg[1]="壬";
				break;
			case 7:
				tg[1]="癸";
				break;
			case 8:
				tg[1]="甲";
				break;
			case 9:
				tg[1]="乙";
				break;
			case 10:
				tg[1]="丙";
				break;
			case 11:
				tg[1]="丁";
				break;
				
	        }
	}else if(tg[0]=="乙"||tg[0]=="庚"){
		switch(tm%12){
			case 0:
				tg[1]="戊";
				break;
			case 1:
				tg[1]="己";
				break;
			case 2:
				tg[1]="庚";
				break;
			case 3:
				tg[1]="辛";
				break;
			case 4:
				tg[1]="壬";
				break;
			case 5:
				tg[1]="癸";
				break;
			case 6:
				tg[1]="甲";
				break;
			case 7:
				tg[1]="乙";
				break;
			case 8:
				tg[1]="丙";
				break;
			case 9:
				tg[1]="丁";
				break;
			case 10:
				tg[1]="戊";
				break;
			case 11:
				tg[1]="己";
				break;
				
	        }
	}else if(tg[0]=="丙"||tg[0]=="辛"){
		switch(tm%12){
			case 0:
				tg[1]="庚";
				break;
			case 1:
				tg[1]="辛";
				break;
			case 2:
				tg[1]="壬";
				break;
			case 3:
				tg[1]="癸";
				break;
			case 4:
				tg[1]="甲";
				break;
			case 5:
				tg[1]="乙";
				break;
			case 6:
				tg[1]="丙";
				break;
			case 7:
				tg[1]="丁";
				break;
			case 8:
				tg[1]="戊";
				break;
			case 9:
				tg[1]="己";
				break;
			case 10:
				tg[1]="庚";
				break;
			case 11:
				tg[1]="辛";
				break;
				
	        }
	}else if(tg[0]=="丁"||tg[0]=="壬"){
		switch(tm%12){
			case 0:
				tg[1]="壬";
				break;
			case 1:
				tg[1]="癸";
				break;
			case 2:
				tg[1]="甲";
				break;
			case 3:
				tg[1]="乙";
				break;
			case 4:
				tg[1]="丙";
				break;
			case 5:
				tg[1]="丁";
				break;
			case 6:
				tg[1]="戊";
				break;
			case 7:
				tg[1]="己";
				break;
			case 8:
				tg[1]="庚";
				break;
			case 9:
				tg[1]="辛";
				break;
			case 10:
				tg[1]="壬";
				break;
			case 11:
				tg[1]="癸";
				break;
				
	        }
	}else if(tg[0]=="戊"||tg[0]=="癸"){
		switch(tm%12){
			case 0:
				tg[1]="甲";
				break;
			case 1:
				tg[1]="乙";
				break;
			case 2:
				tg[1]="丙";
				break;
			case 3:
				tg[1]="丁";
				break;
			case 4:
				tg[1]="戊";
				break;
			case 5:
				tg[1]="己";
				break;
			case 6:
				tg[1]="庚";
				break;
			case 7:
				tg[1]="辛";
				break;
			case 8:
				tg[1]="壬";
				break;
			case 9:
				tg[1]="癸";
				break;
			case 10:
				tg[1]="甲";
				break;
			case 11:
				tg[1]="乙";
				break;
				
	        }	
	}
var jda,thes,dayjd,dgz;
//計算日柱之干支
//jda = Jdays(op, yea, tmon, tday, thehou) + 0.5;     //加0.5是將起始點從正午改為從0點開始。
jda=spcjd+0.5;

thes = ((jda - Math.floor(jda)) * 86400) + 3600;    //將jd的小數部份化為秒，並加上起始點前移的一小時(3600秒)，取其整數值
dayjd = Math.floor(jda) + thes / 86400;              //將秒數化為日數，加回到jd的整數部份
dgz = (Math.floor(dayjd + 49) % 60 + 60) % 60;

var dtg=dgz % 10;
var ddz=dgz % 12;

	switch(dtg){
		case 0:
			tg[2] ="甲";
			break;
		case 1:
			tg[2] ="乙";
			break;
		case 2:
			tg[2] ="丙";
			break;
		case 3:
			tg[2] ="丁";
			break;
		case 4:
			tg[2] ="戊";
			break;
		case 5:
			tg[2] ="己";
			break;
		case 6:
			tg[2] ="庚";
			break;
		case 7:
			tg[2] ="辛";
			break;
		case 8:
			tg[2] ="壬";
			break;
		case 9:
			tg[2] ="癸";
			break;
	       }
	switch(ddz){
		case 0:
			dz[2] ="子";
			break;
		case 1:
			dz[2] ="丑";
			break;
		case 2:
			dz[2] ="寅";
			break;
		case 3:
			dz[2] ="卯";
			break;
		case 4:
			dz[2] ="辰";
			break;
		case 5:
			dz[2] ="巳";
			break;
		case 6:
			dz[2] ="午";
			break;
		case 7:
			dz[2] ="未";
			break;
		case 8:
			dz[2] ="申";
			break;
		case 9:
			dz[2] ="酉";
			break;
		case 10:
			dz[2] ="戌";
			break;
		case 11:
			dz[2] ="亥";
			break;
	       }

var hgz
//計算時柱之干支
dh = dayjd * 12;
hgz = (Math.floor(dh + 48) % 60 + 60) % 60;
var htg = hgz % 10;    //時干
var hdz= hgz % 12;    //時支
	switch(htg){
		case 0:
			tg[3] ="甲";
			break;
		case 1:
			tg[3] ="乙";
			break;
		case 2:
			tg[3] ="丙";
			break;
		case 3:
			tg[3] ="丁";
			break;
		case 4:
			tg[3] ="戊";
			break;
		case 5:
			tg[3] ="己";
			break;
		case 6:
			tg[3] ="庚";
			break;
		case 7:
			tg[3] ="辛";
			break;
		case 8:
			tg[3] ="壬";
			break;
		case 9:
			tg[3] ="癸";
			break;
	       }
	switch(hdz){
		case 0:
			dz[3] ="子";
			break;
		case 1:
			dz[3] ="丑";
			break;
		case 2:
			dz[3] ="寅";
			break;
		case 3:
			dz[3] ="卯";
			break;
		case 4:
			dz[3] ="辰";
			break;
		case 5:
			dz[3] ="巳";
			break;
		case 6:
			dz[3] ="午";
			break;
		case 7:
			dz[3] ="未";
			break;
		case 8:
			dz[3] ="申";
			break;
		case 9:
			dz[3] ="酉";
			break;
		case 10:
			dz[3] ="戌";
			break;
		case 11:
			dz[3] ="亥";
			break;
	       }
//alert(tg[0]+" "+tg[1]+" "+tg[2]+" "+tg[3]+"\n"+dz[0]+" "+dz[1]+" "+dz[2]+" "+dz[3]);
}
</script>

</body>
</html>
