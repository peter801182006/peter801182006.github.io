<!DOCTYPE html>
<html>
<body>

<p>請輸入西元年分:</p>

<input id="yid" type="number" min="0" max="3000" required>
<p>請輸入月分:</p>

<input id="mid" type="number" min="1" max="12" required>
<p>請輸入日期:</p>

<input id="did" type="number" min="1" max="31" required>
<p>請輸入時間點:(時間點不知道可以任挑)</p>

<input id="hid" type="number" min="0" max="23" required><p>時</p>
<input id="miid" type="number" min="0" max="59" required><p>分</p>

<button onclick="myFunction()">OK</button>



<p>主要屬性:</p>
<p id="demo"></p>
<p>內心世界:</p>
<p id="demo2"></p>
<p>幸運色</p>
<p id="color"></p>
<script>
//日誌0:1/23
//日誌1:1/24 20:00-23:50
//日誌2:1/25 6:30-07:09 變數進不去
     var year = document.getElementById("yid");
     var month = document.getElementById("mid");
     var day = document.getElementById("did");
     var hour= document.getElementById("hid");
     var min= document.getElementById("miid");
    
    var synmonth = 29.530588853;     //synodic month (new Moon to new Moon)
//偏移量參數:
     ptsa = new Array(485, 203, 199, 182, 156, 136, 77, 74, 70, 58, 52, 50, 45, 44, 29, 18, 17, 16, 14, 12, 12, 12, 9, 8);
     ptsb = new Array(324.96, 337.23, 342.08, 27.85, 73.14, 171.52, 222.54, 296.72, 243.58, 119.81, 297.17, 21.02, 247.54, 325.15, 60.93, 155.12, 288.79, 198.04, 199.76, 95.39, 287.11, 320.81, 227.73, 15.45);
     ptsc = new Array(1934.136, 32964.467, 20.186, 445267.112, 45036.886, 22518.443, 65928.934, 3034.906, 9037.513, 33718.147, 150.678, 2281.226, 29929.562, 31555.956, 4443.417, 67555.328, 4562.452, 62894.029, 31436.921, 14577.848, 31931.756, 34777.259, 1222.114, 16859.074);
//
    var ctg = new Array("甲", "乙", "丙", "丁", "戊", "己", "庚", "辛", "壬", "癸");
    var cdz = new Array("子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥");
     jdez=new Array;
	
function myFunction() {
     var yy =Number(year.value);
     var mm =Number( month.value);
     var dd =Number( day.value);
     var hh= Number(hour.value);
     var mimi= Number(min.value);
//      alert(typeof(yy));
    if (!ValidDate()) {
//         document.getElementById("demo").innerHTML ="時間點不正確，請重新輸入" ;
	    alert("時間點不正確，請重新輸入");
    } else {  
	var a=Jdays(yy,mm,dd,hh+(mimi/60));
        var tg=new Array;
	var dz=new Array;

         GetGZ(a,yy,ptsa,ptsb,ptsc,tg,dz);
	    
	document.getElementById("demo").innerHTML  = tg[2];    
	document.getElementById("demo2").innerHTML = dz[1]; 
        
        var colorbase=["綠色系","粉紅、紅色系","黃色、咖啡色色系","銀白色系","藍黑色系"]
        if(tg[2]=="甲"||tg[2]=="乙"){
                 document.getElementById("color").innerHTML=
                  "求身體健康"+colorbase[0]+"\n"
                  +"求才華"+ colorbase[1]+"\n"
                  +"求財運"+colorbase[2]+"\n"
                  +"求考運"+colorbase[3]+"\n"
                  +"求貴人"+colorbase[4]+"\n";      
        }else if(tg[2]=="丙"||tg[2]=="丁"){
                 document.getElementById("color").innerHTML=
                  "求身體健康"+colorbase[1]+"\n"
                  +"求才華"+ colorbase[2]+"\n"
                  +"求財運"+colorbase[3]+"\n"
                  +"求考運"+colorbase[4]+"\n"
                  +"求貴人"+colorbase[0]+"\n";      
        }else if(tg[2]=="戊"||tg[2]=="己"){
                 document.getElementById("color").innerHTML=
                  "求身體健康"+colorbase[2]+"\n"
                  +"求才華"+ colorbase[3]+"\n"
                  +"求財運"+colorbase[4]+"\n"
                  +"求考運"+colorbase[0]+"\n"
                  +"求貴人"+colorbase[1]+"\n";      
        }else if(tg[2]=="庚"||tg[2]=="辛"){
                 document.getElementById("color").innerHTML=
                  "求身體健康"+colorbase[3]+"\n"
                  +"求才華"+ colorbase[4]+"\n"
                  +"求財運"+colorbase[0]+"\n"
                  +"求考運"+colorbase[1]+"\n"
                  +"求貴人"+colorbase[2]+"\n";      
        }else if(tg[2]=="壬"||tg[2]=="癸"){
                 document.getElementById("color").innerHTML=
                  "求身體健康"+colorbase[4]+"\n"
                  +"求才華"+ colorbase[0]+"\n"
                  +"求財運"+colorbase[1]+"\n"
                  +"求考運"+colorbase[2]+"\n"
                  +"求貴人"+colorbase[3]+"\n";      
        }


    }    
	//1/25 07:09 yy進不去
        
	
}
//ValidDate()已於1/24上午6:35確認可執行
function ValidDate(){
        var vd=true;
	if(month.checkValidity()==false){
           vd=false;
	}else{

           var u1=-(year.value%4==0);//能被4整除-1其餘為0
           var u2=( (year.value%100==0)-(year%400==0) )&&(year>1582);//1582以後且年份能被100整除，但不能被400除盡的年份不是閏年
           var u=u1+u2;
           //計算當月天數 以7.5月為中央 與中央差+0.5%2餘數為1的才要加1 ，當月分為2才須減2或減1(閏年)
           var vmd=30+( (Math.abs(month.value-7.5)+0.5) %2)-(month.value==2)*(2+u)
           if(day.checkValidity()==false || day.value>vmd){
		if(u==0 && month.value==2 && day.value==29){
			if(hour.checkValidity()==false ||min.checkValidity()==false){
			   alert("時間點不正確，請重新輸入");
		        }else{
                           alert("此年無閏月");
			}
		}else{
		   	alert("時間點不正確，請重新輸入");
                }
	        vd=false;
            }
	    if(year.value ==1582 && month.value==10 && day.value>=5 &&day.value<15||hour.checkValidity()==false ||min.checkValidity()==false){
                alert("時間點不正確，請重新輸入");
                vd=false;
	    }
	}
//         if(vd==true)document.getElementById("demo").innerHTML = "甲";
//         else document.getElementById("demo").innerHTML = "乙";
        return vd;
		   
}
// function Jtime(){
	
// }
	
//計算當年春分點
function VE(yy){
    var yx=yy;
    if(yx>=1000 && yx<=8001){
	   var m=(yx-2000)/1000;
	   jdve=2451623.80984+365242.37404*m+0.05169*m*m-0.00411*m*m*m-0.00057*m*m*m*m;
    }else{
	    if(yx>=0 && yx<1000){
		   m=yx/1000;
		   jdve=1721139.29189+365242.1374*m+0.06134*m*m+0.00111*m*m*m-0.00071*m*m*m*m;
	    }else{
		   alert("超出计算能力范围");
		   return false;
	    }
    }
         return jdve
}

function MeanJQJD(yy,jdve,ty,ini,num){
//for 偏心率計算:------------------------------------------------
   var ath=2*Math.PI/24;
   var tx=(jdve-2451545)/365250;
   var e=0.0167086342-0.0004203654*tx-0.0000126734*tx*tx+0.0000001444*tx*tx*tx-0.0000000002*tx*tx*tx*tx+0.0000000003*tx*tx*tx*tx*tx;
//每年退行角度計算:-----------------------------------------------
   var tt=yy/1000;       
//       計算式
   var vp=111.25586939-17.0119934518333*tt-0.044091890166673*tt*tt-4.37356166661345E-04*tt*tt*tt+8.16716666602386E-06*tt*tt*tt*tt;
//       轉成徑度量
   var rvp=vp*2*Math.PI/360;
//切割點:
   var peri = new Array(30);
   var i;
   for(i=1;i<=(ini+num);i++){
	    var flag=0;
	    var th=ath*(i-1)+rvp;
	    if(th>Math.PI && th<=3*Math.PI){
		     th=2*Math.PI-th;
		     flag=1;
	    }
	    if(th>3*Math.PI){
		     th=4*Math.PI-th;
		     flag=2;
	    }
	    var f1=2*Math.atan((Math.sqrt((1-e)/(1+e))*Math.tan(th/2)));
	    var f2=(e*Math.sqrt(1-e*e)*Math.sin(th))/(1+e*Math.cos(th));
	    var f=(f1-f2)*ty/2/Math.PI;
	    if(flag==1) f=ty-f;
	    if(flag==2) f=2*ty-f;
	    peri[i]=f;
   }
   for(i=ini;i<=(ini+num);i++){
	    jdez[i]=jdve+peri[i]-peri[1];
   }
   return true;
}
	
function Perturbation(jdez){
     var t=(jdez-2451545)/36525;
     var s=0;
     for(k=0;k<=23;k++){
	s=s+ptsa[k]*Math.cos(ptsb[k]*2*Math.PI/360+ptsc[k]*2*Math.PI/360*t);
     }
     var w=35999.373*t-2.47;
     var l=1+0.0334*Math.cos(w*2*Math.PI/360)+0.0007*Math.cos(2*w*2*Math.PI/360);
     var ptb=0.00001*s/l;
     return ptb;
}

function DeltaT(yy , mm ){
     var u, t, dt, y;
     y = yy + (mm - 0.5) / 12;

     if(y<=-500){	
	u = (y - 1820) / 100;
	dt = (-20 + 32*u*u);}
     else{if(y< 500){
	u = y / 100;
	dt=(10583.6-1014.41*u+33.78311*u*u-5.952053*u*u*u-0.1798452*u*u*u*u+0.022174192*u*u*u*u*u+0.0090316521*u*u*u*u*u*u);}
     else{if(y<1600){
	u = (y - 1000) / 100;
	dt = (1574.2-556.01*u+71.23472*u*u+0.319781*u*u*u-0.8503463*u*u*u*u-0.005050998*u*u*u*u*u+ 0.0083572073*u*u*u*u*u*u);}
     else{if(y<1700){
	t = y - 1600;
	dt = (120 - 0.9808 * t - 0.01532 * t*t + t*t*t / 7129);}
     else{if(y<1800){
	t = y - 1700;
	dt = (8.83 + 0.1603 * t - 0.0059285 * t*t + 0.00013336 * t*t*t - t*t*t*t / 1174000);}
     else{if(y<1860){
	t = y - 1800;
	dt=(13.72-0.332447*t+0.0068612*t*t+0.0041116*t*t*t-0.00037436*t*t*t*t+0.0000121272*t*t*t*t*t-0.0000001699*t*t*t*t*t*t+ 0.000000000875*t*t*t*t*t*t*t);}
     else{if(y<1900){
	t = y - 1860;
	dt = (7.62 + 0.5737 * t - 0.251754 * t*t + 0.01680668 * t*t*t - 0.0004473624 * t*t*t*t + t*t*t*t*t / 233174);}
     else{if(y<1920){
	t = y - 1900;
	dt = (-2.79 + 1.494119 * t - 0.0598939 * t*t + 0.0061966 * t*t*t - 0.000197 * t*t*t*t);}
     else{if(y<1941){
	t = y - 1920;
	dt = (21.2 + 0.84493 * t - 0.0761 * t*t + 0.0020936 * t*t*t);}
     else{if(y<1961){
	t = y - 1950;
	dt = (29.07 + 0.407 * t - t*t / 233 + t*t*t / 2547);}
     else{if(y<1986){
	t = y - 1975;
	dt = (45.45 + 1.067 * t - t*t / 260 - t*t*t / 718);}
     else{if(y<2005){
	t = y - 2000;
	dt = (63.86 + 0.3345 * t - 0.060374 * t*t + 0.0017275 * t*t*t + 0.000651814 * t*t*t*t + 0.00002373599 * t*t*t*t*t);}
     else{if(y<2050){
	t = y - 2000;
	dt = (62.92 + 0.32217 * t + 0.005589 * t*t);}
     else{if(y<2150){
	u = (y - 1820) / 100;
	dt = (-20 + 32*u*u-0.5628*(2150 - y));}
     else{
	u = (y - 1820) / 100;
	dt = (-20 + 32*u*u);}}}}}}}}}}}}}}

        if(y<1955 || y>=2005) dt=dt-(0.000012932*(y-1955)*(y-1955));
        var DeltaT = dt / 60;    //將秒轉換為分
        return DeltaT
}

function Jdays( yr,mh,dy,hr ){//將年月日時，轉换爲儒略日 
        
        var yp=yr+Math.floor((mh-3)/10);
        if(((yr>1582) || (yr==1582 && mh>10) || (yr==1582 && mh==10 && dy>=15))){
	     var init=1721119.5;
	     var jdy=Math.floor(yp*365.25)-Math.floor(yp/100)+Math.floor(yp/400);
        }else{
	    if((yr<1582) || (yr==1582 && mh<10) || (yr==1582 && mh==10 && dy<=4)){
		var init=1721117.5;
		var jdy=Math.floor(yp*365.25);
	    }else {return false;}
        }
	var mp=Math.floor(mh+9)%12; 
        var jdm=mp*30+Math.floor((mp+1)*34/57);
        var jdd=dy-1;
        var jdh=hr/24;
        
        var jd=jdy+jdm+jdd+jdh+init;
        return jd;
}
	
	
//////////////////////////////////////////////////////////
function Jtime(op,jd){//将儒略日转换为年月日时分秒
if(jd>=2299160.5 || op){
	var y4h=146097;
	var init=1721119.5;
}
else{
	var y4h=146100;
	var init=1721117.5;
}
var jdr=Math.floor(jd-init);
var yh=y4h/4;
var cen=Math.floor((jdr+0.75)/yh);
var d=Math.floor(jdr+0.75-cen*yh);
var ywl=1461/4;
var jy=Math.floor((d+0.75)/ywl);
d=Math.floor(d+0.75-ywl*jy+1);
var ml=153/5;
mp=Math.floor((d-0.5)/ml);
d=Math.floor((d-0.5)-30.6*mp+1);
var y=(100*cen)+jy;
var m=(mp+2)%12+1;
if(m<3) y=y+1;
var sd=Math.floor((jd+0.5-Math.floor(jd+0.5))*24*60*60+0.00005);
var mt=Math.floor(sd/60);
var ss=sd%60;
var hh=Math.floor(mt/60);
var mmt=mt%60;
var yy=Math.floor(y);
var mm=Math.floor(m);
var dd=Math.floor(d);
var yc="     "+yy;
yc=yc.substr(yc.length-5,5);
var dytm=yc;dytm+="年";
dytm+= ((mm < 10) ? "0" : "") + mm+"月";
dytm+= ((dd < 10) ? "0" : "") + dd+"日";
dytm+= ((hh < 10) ? "0" : "") + hh+"时";
dytm+= ((mmt < 10) ? "0" : "") + mmt+"分";
dytm+= ((ss < 10) ? "0" : "") + ss+"秒";
return dytm;
}

//副程式功能：對Perturbaton作調整後的自春分點開始的24節氣,可只取部份
function GetAdjustedJQ(yy, ini, num, jdjq){
var veb=VE(yy);
var ty=VE(yy+1)-veb;     //求指定年的春分點及回歸年長
if(MeanJQJD(yy,veb,ty,ini,num)==true){	//輸入指定年,JD,回歸年長,求該回歸年各節氣之長
		for(i=ini+1;i<=(ini+num);i++){
			ptb=Perturbation(jdez[i]);	//取得受perturbation影響所需微調
			dt=DeltaT(yy,Math.floor(i/2)+3);	//修正dynamical time to Universal time
			jdjq[i]=jdez[i]+ptb-dt/60/24;	//加上攝動調整值ptb，減去對應的Delta T值(分鐘轉換為日)
			jdjq[i]=jdjq[i]+1/3;	//因中國時間比格林威治時間先行8小時，即1/3日
		}
	}

}

//副程式功能：求出以立春點開始的不含中氣之12節氣
function GetPureJQsinceSpring(yy, ptsa,ptsb,ptsc, jdpjq){
var sjdjq=new Array;
var yea = yy - 1;
GetAdjustedJQ(yea, 21, 3, sjdjq);   //求出含指定年立春開始之3個節氣JD值,以前一年的年值代入
//轉移春分前之立春至驚蟄之節氣至jdpjq變數中，以重整index
jdpjq[0] =sjdjq[22];                     //此為立春
jdpjq[1] =sjdjq[24];                     //此為驚蟄
yea = yy;
GetAdjustedJQ(yea, 0, 26, sjdjq);       //求出指定年節氣之JD值,從驚蟄開始，到雨水
//轉移春分至小寒之節氣至jdpjq變數中，以重整index
for(i=1;i<=13;i++){
    jdpjq[i+1] = sjdjq[2 * i];
}
}
// 1/25 07:05 bug變數進不去
function GetGZ(spcjd,ya,ptsa,ptsb,ptsc,tg,dz){
   var ty;
   var td;
   var dh;
	
//比較求算節氣年ty,求出年干支
   var jr=new Array;
   GetPureJQsinceSpring(ya, ptsa,ptsb,ptsc,jr);	//取得自立春開始的非中氣之24節氣
   if(spcjd <jr[0]){	//jr[0]為立春，約在2月5日前後，
        ty = ya - 1;
       //若小於jr[0],則屬於前一個節氣年
       GetPureJQsinceSpring(ty, ptsa,ptsb,ptsc,jr);     //取得自立春開始的不含中氣之12節氣  
   }

   switch(ty%10){
	case 0:
		tg[0]="庚";
		break;
	case 1:
		tg[0]="辛";
                break;
        case 2:
		tg[0]="壬";
		break;
        case 3:
		tg[0]="癸";
		break;
	case 4:
		tg[0]="甲";
		break;
	case 5:
		tg[0]="乙";
		break;
        case 6:
		tg[0]="丙";
		break;
	case 7:
		tg[0]="丁";
		break;
	case 8:
		tg[0]="戊";
		break;
	case 9:
		tg[0]="己";
		break;
      }
	switch(ty%12){
		case 0:
			dz[0]="申";
			break;
		case 1:
			dz[0]="酉";
			break;
		case 2:
			dz[0]="戌";
			break;
		case 3:
			dz[0]="亥";
			break;
		case 4:
			dz[0]="子";
			break;
		case 5:
			dz[0]="丑";
			break;
		case 6:
			dz[0]="寅";
			break;
		case 7:
			dz[0]="卯";
			break;
		case 8:
			dz[0]="辰";
			break;
		case 9:
			dz[0]="巳";
			break;
		case 10:
			dz[0]="午";
			break;
		case 11:
			dz[0]="未";
			break;
		}
	var j,tm,tmm;
	//比較求算節氣月,求出月干支
	for(j=0;j<=13;j++){
		if(jr[j] >= spcjd){ tm = j - 1; break;}		//已超過指定時刻，故應取前一個節氣
	}

	switch(tm%12){
		case 0:
			dz[1]="寅";
			break;
		case 1:
			dz[1]="卯";
			break;
		case 2:
			dz[1]="辰";
			break;
		case 3:
			dz[1]="巳";
			break;
		case 4:
			dz[1]="午";
			break;
		case 5:
			dz[1]="未";
			break;
		case 6:
			dz[1]="申";
			break;
		case 7:
			dz[1]="酉";
			break;
		case 8:
			dz[1]="戌";
			break;
		case 9:
			dz[1]="亥";
			break;
		case 10:
			dz[1]="子";
			break;
		case 11:
			dz[1]="丑";
			break;
	}
	if(tg[0]=="甲"||tg[0]=="己"){
		switch(tm%12){
			case 0:
				tg[1]="丙";
				break;
			case 1:
				tg[1]="丁";
				break;
			case 2:
				tg[1]="戊";
				break;
			case 3:
				tg[1]="己";
				break;
			case 4:
				tg[1]="庚";
				break;
			case 5:
				tg[1]="辛";
				break;
			case 6:
				tg[1]="壬";
				break;
			case 7:
				tg[1]="癸";
				break;
			case 8:
				tg[1]="甲";
				break;
			case 9:
				tg[1]="乙";
				break;
			case 10:
				tg[1]="丙";
				break;
			case 11:
				tg[1]="丁";
				break;
				
	        }
	}else if(tg[0]=="乙"||tg[0]=="庚"){
		switch(tm%12){
			case 0:
				tg[1]="戊";
				break;
			case 1:
				tg[1]="己";
				break;
			case 2:
				tg[1]="庚";
				break;
			case 3:
				tg[1]="辛";
				break;
			case 4:
				tg[1]="壬";
				break;
			case 5:
				tg[1]="癸";
				break;
			case 6:
				tg[1]="甲";
				break;
			case 7:
				tg[1]="乙";
				break;
			case 8:
				tg[1]="丙";
				break;
			case 9:
				tg[1]="丁";
				break;
			case 10:
				tg[1]="戊";
				break;
			case 11:
				tg[1]="己";
				break;
				
	        }
	}else if(tg[0]=="丙"||tg[0]=="辛"){
		switch(tm%12){
			case 0:
				tg[1]="庚";
				break;
			case 1:
				tg[1]="辛";
				break;
			case 2:
				tg[1]="壬";
				break;
			case 3:
				tg[1]="癸";
				break;
			case 4:
				tg[1]="甲";
				break;
			case 5:
				tg[1]="乙";
				break;
			case 6:
				tg[1]="丙";
				break;
			case 7:
				tg[1]="丁";
				break;
			case 8:
				tg[1]="戊";
				break;
			case 9:
				tg[1]="己";
				break;
			case 10:
				tg[1]="庚";
				break;
			case 11:
				tg[1]="辛";
				break;
				
	        }
	}else if(tg[0]=="丁"||tg[0]=="壬"){
		switch(tm%12){
			case 0:
				tg[1]="壬";
				break;
			case 1:
				tg[1]="癸";
				break;
			case 2:
				tg[1]="甲";
				break;
			case 3:
				tg[1]="乙";
				break;
			case 4:
				tg[1]="丙";
				break;
			case 5:
				tg[1]="丁";
				break;
			case 6:
				tg[1]="戊";
				break;
			case 7:
				tg[1]="己";
				break;
			case 8:
				tg[1]="庚";
				break;
			case 9:
				tg[1]="辛";
				break;
			case 10:
				tg[1]="壬";
				break;
			case 11:
				tg[1]="癸";
				break;
				
	        }
	}else if(tg[0]=="戊"||tg[0]=="癸"){
		switch(tm%12){
			case 0:
				tg[1]="甲";
				break;
			case 1:
				tg[1]="乙";
				break;
			case 2:
				tg[1]="丙";
				break;
			case 3:
				tg[1]="丁";
				break;
			case 4:
				tg[1]="戊";
				break;
			case 5:
				tg[1]="己";
				break;
			case 6:
				tg[1]="庚";
				break;
			case 7:
				tg[1]="辛";
				break;
			case 8:
				tg[1]="壬";
				break;
			case 9:
				tg[1]="癸";
				break;
			case 10:
				tg[1]="甲";
				break;
			case 11:
				tg[1]="乙";
				break;
				
	        }	
	}
var jda,thes,dayjd,dgz;
//計算日柱之干支
//jda = Jdays(op, yea, tmon, tday, thehou) + 0.5;     //加0.5是將起始點從正午改為從0點開始。
jda=spcjd+0.5;
thes = ((jda - Math.floor(jda)) * 86400) + 3600;    //將jd的小數部份化為秒，並加上起始點前移的一小時(3600秒)，取其整數值
dayjd = Math.floor(jda) + thes / 86400;              //將秒數化為日數，加回到jd的整數部份
dgz = (Math.floor(dayjd + 49) % 60 + 60) % 60;
var dtg=dgz % 10;
var ddz=dgz % 12;
	switch(dtg){
		case 0:
			tg[2] ="甲";
			break;
		case 1:
			tg[2] ="乙";
			break;
		case 2:
			tg[2] ="丙";
			break;
		case 3:
			tg[2] ="丁";
			break;
		case 4:
			tg[2] ="戊";
			break;
		case 5:
			tg[2] ="己";
			break;
		case 6:
			tg[2] ="庚";
			break;
		case 7:
			tg[2] ="辛";
			break;
		case 8:
			tg[2] ="壬";
			break;
		case 9:
			tg[2] ="癸";
			break;
	       }
	switch(ddz){
		case 0:
			dz[2] ="子";
			break;
		case 1:
			dz[2] ="丑";
			break;
		case 2:
			dz[2] ="寅";
			break;
		case 3:
			dz[2] ="卯";
			break;
		case 4:
			dz[2] ="辰";
			break;
		case 5:
			dz[2] ="巳";
			break;
		case 6:
			dz[2] ="午";
			break;
		case 7:
			dz[2] ="未";
			break;
		case 8:
			dz[2] ="申";
			break;
		case 9:
			dz[2] ="酉";
			break;
		case 10:
			dz[2] ="戌";
			break;
		case 11:
			dz[2] ="亥";
			break;
	       }

var hgz
//計算時柱之干支
dh = dayjd * 12;
hgz = (Math.floor(dh + 48) % 60 + 60) % 60;
var htg = hgz % 10;    //時干
var hdz= hgz % 12;    //時支
	switch(htg){
		case 0:
			tg[3] ="甲";
			break;
		case 1:
			tg[3] ="乙";
			break;
		case 2:
			tg[3] ="丙";
			break;
		case 3:
			tg[3] ="丁";
			break;
		case 4:
			tg[3] ="戊";
			break;
		case 5:
			tg[3] ="己";
			break;
		case 6:
			tg[3] ="庚";
			break;
		case 7:
			tg[3] ="辛";
			break;
		case 8:
			tg[3] ="壬";
			break;
		case 9:
			tg[3] ="癸";
			break;
	       }
	switch(hdz){
		case 0:
			dz[3] ="子";
			break;
		case 1:
			dz[3] ="丑";
			break;
		case 2:
			dz[3] ="寅";
			break;
		case 3:
			dz[3] ="卯";
			break;
		case 4:
			dz[3] ="辰";
			break;
		case 5:
			dz[3] ="巳";
			break;
		case 6:
			dz[3] ="午";
			break;
		case 7:
			dz[3] ="未";
			break;
		case 8:
			dz[3] ="申";
			break;
		case 9:
			dz[3] ="酉";
			break;
		case 10:
			dz[3] ="戌";
			break;
		case 11:
			dz[3] ="亥";
			break;
	       }
}
</script>

</body>
</html>
